<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Routine - 19th Batch Economics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8fafc;
        }
        .main-border {
            border: 2px solid #000000;
        }
        @media (min-width: 768px) {
            .main-border { border-width: 4px; }
        }
        .cell-border {
            border: 2px solid #000000;
        }
        @media (min-width: 768px) {
            .cell-border { border-width: 3px; }
        }
        @media print {
            .no-print { display: none !important; }
            body { background-color: white !important; padding: 0 !important; }
            .main-border { border-width: 4px !important; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            /* Force grid layout on print even if on mobile */
            #grid-container {
                display: grid !important;
                grid-template-columns: 140px repeat(5, 1fr) !important;
            }
            .day-header-mobile { display: none !important; }
            .time-label-mobile { display: none !important; }
        }
        
        /* Desktop Grid Layout */
        .disconnected-grid {
            display: grid;
            grid-template-columns: 100px repeat(5, 1fr);
            gap: 0.5rem;
        }
        @media (min-width: 1024px) {
            .disconnected-grid {
                grid-template-columns: 140px repeat(5, 1fr);
                gap: 1rem;
            }
        }

        /* Mobile Adjustments */
        @media (max-width: 767px) {
            .disconnected-grid {
                display: block; /* Stack on mobile */
            }
            .mobile-day-section {
                margin-bottom: 2rem;
            }
            .mobile-day-title {
                display: block;
                background: #000;
                color: #fff;
                padding: 0.5rem;
                border-radius: 0.75rem;
                margin-bottom: 0.75rem;
                font-weight: 800;
                text-transform: uppercase;
                text-align: center;
            }
            .mobile-row {
                display: flex;
                gap: 0.75rem;
                margin-bottom: 0.75rem;
                align-items: stretch;
            }
            .time-column-mobile {
                flex: 0 0 80px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.7rem;
                font-weight: 800;
                text-align: center;
                background: #f1f5f9;
                border-radius: 0.5rem;
                padding: 0.25rem;
            }
            .card-column-mobile {
                flex: 1;
            }
        }

        /* Split cell styling */
        .split-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }
        .split-half {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4px;
        }
        .split-divider {
            height: 2px;
            background-color: #000;
            width: 100%;
        }
    </style>
</head>
<body class="p-2 md:p-10">

    <!-- Actions -->
    <div class="max-w-[1200px] mx-auto mb-4 md:mb-8 flex gap-2 md:gap-4 no-print justify-center md:justify-end">
        <button onclick="downloadPNG()" class="bg-black text-white px-4 md:px-6 py-2 md:py-3 rounded-full text-sm md:text-base font-bold hover:bg-gray-800 transition-all flex items-center gap-2">
            Save PNG
        </button>
        <button onclick="window.print()" class="bg-white text-black border-2 border-black px-4 md:px-6 py-2 md:py-3 rounded-full text-sm md:text-base font-bold hover:bg-gray-100 transition-all">
            Print PDF
        </button>
    </div>

    <!-- Capture Area -->
    <div id="capture-area" class="max-w-[1200px] mx-auto p-4 md:p-10 bg-white main-border rounded-[1.5rem] md:rounded-[2.5rem]">
        
        <!-- Header -->
        <div class="mb-4 md:mb-6 text-center">
            <h1 class="text-2xl md:text-4xl font-extrabold uppercase tracking-tight mb-1 md:mb-2">Class Routine</h1>
            <p class="text-sm md:text-xl font-semibold uppercase">
                19th Batch • Economics • 2nd Sem
                <br>
                <span id="active-section-display" class="text-black bg-yellow-300 px-3 md:px-4 py-0.5 md:py-1 rounded-lg mt-1 md:mt-2 inline-block text-[10px] md:text-sm">Combined (Section A + B)</span>
            </p>
            <div class="w-16 md:w-24 h-1 md:h-2 bg-black mx-auto mt-2 md:mt-4 rounded-full"></div>
        </div>

        <!-- Section Toggles (No Print) -->
        <div class="flex flex-wrap gap-2 mb-6 no-print justify-center">
            <button onclick="updateView('A')" id="tab-A" class="flex-1 md:flex-none px-3 md:px-6 py-2 rounded-xl border-2 border-black font-bold bg-white text-black text-xs md:text-base transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">Sec A</button>
            <button onclick="updateView('B')" id="tab-B" class="flex-1 md:flex-none px-3 md:px-6 py-2 rounded-xl border-2 border-black font-bold bg-white text-black text-xs md:text-base transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">Sec B</button>
            <button onclick="updateView('COMBINED')" id="tab-COMBINED" class="w-full md:w-auto px-6 py-2 rounded-xl border-2 border-black font-bold bg-black text-white text-xs md:text-base transition-colors shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]">Combined</button>
        </div>

        <!-- Legend Area -->
        <div class="mb-6 md:mb-8 border-b-2 border-slate-100 pb-4 md:pb-6">
            <!-- Combined Legend (Sections) -->
            <div id="legend-combined" class="flex justify-center gap-4 md:gap-8 hidden">
                <div class="flex items-center gap-2 md:gap-3">
                    <div class="w-4 h-4 md:w-6 md:h-6 rounded border-2 border-black bg-[#dbeafe]"></div>
                    <span class="text-[10px] md:text-xs font-extrabold uppercase tracking-widest">Sec A</span>
                </div>
                <div class="flex items-center gap-2 md:gap-3">
                    <div class="w-4 h-4 md:w-6 md:h-6 rounded border-2 border-black bg-[#ffe4e6]"></div>
                    <span class="text-[10px] md:text-xs font-extrabold uppercase tracking-widest">Sec B</span>
                </div>
            </div>

            <!-- Section A/B Legend (Courses) -->
            <div id="legend-courses" class="flex flex-wrap justify-center gap-x-4 md:gap-x-8 gap-y-2 md:gap-y-3 hidden">
                <!-- Injected by JS -->
            </div>
        </div>

        <!-- Grid Container -->
        <div class="disconnected-grid" id="grid-container">
            <!-- Content Injected by JavaScript -->
        </div>

        <!-- Footer Info -->
        <div class="mt-8 md:mt-12 flex flex-col md:flex-row justify-between items-center md:items-end gap-4 text-center md:text-left">
            <div>
                <p class="text-[10px] md:text-sm font-bold uppercase opacity-40 italic leading-none">University of Dhaka</p>
                <p class="text-[8px] md:text-[10px] font-bold text-slate-400 mt-1 uppercase tracking-tighter">Department of Economics</p>
            </div>
            <div class="text-right">
                <p class="text-[8px] md:text-xs font-bold text-slate-400 uppercase">Classes start: Feb 15, 2026</p>
            </div>
        </div>
    </div>

    <script>
        const scheduleData = [
            { day: "Sunday", time: "02:00-03:20", id: "102", room: "301", section: "B" },
            { day: "Sunday", time: "03:30-04:50", id: "102", room: "302", section: "A" },
            { day: "Monday", time: "09:30-10:50", id: "110", room: "4045", section: "B" },
            { day: "Monday", time: "11:00-12:20", id: "110", room: "4045", section: "A" },
            { day: "Monday", time: "11:00-12:20", id: "104", room: "301", section: "B" },
            { day: "Monday", time: "12:30-01:50", id: "104", room: "301", section: "A" },
            { day: "Monday", time: "02:00-03:20", id: "102", room: "302", section: "A" },
            { day: "Monday", time: "03:30-04:50", id: "102", room: "301", section: "B" },
            { day: "Tuesday", time: "02:00-03:20", id: "106", room: "303", section: "A" },
            { day: "Tuesday", time: "03:30-04:50", id: "106", room: "303", section: "B" },
            { day: "Wednesday", time: "09:30-10:50", id: "104", room: "303", section: "B" },
            { day: "Wednesday", time: "11:00-12:20", id: "104", room: "303", section: "A" },
            { day: "Thursday", time: "11:00-12:20", id: "110", room: "301", section: "A" },
            { day: "Thursday", time: "12:30-01:50", id: "110", room: "301", section: "B" },
            { day: "Thursday", time: "02:00-03:20", id: "106", room: "303", section: "B" },
            { day: "Thursday", time: "03:30-04:50", id: "106", room: "301", section: "A" }
        ];

        const courseDetails = {
            "102": { name: "Principles of Macroeconomics", color: "#ffe4e6" }, 
            "104": { name: "Mathematics II", color: "#fef3c7" }, 
            "106": { name: "Statistics II", color: "#f3e8ff" }, 
            "110": { name: "English Comprehension", color: "#cffafe" }  
        };

        const sectionColors = { "A": "#dbeafe", "B": "#ffe4e6" };
        const timeSlots = ["09:30-10:50", "11:00-12:20", "12:30-01:50", "02:00-03:20", "03:30-04:50"];
        const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday"];
        let currentSection = 'COMBINED';

        function updateView(section) {
            currentSection = section;
            document.getElementById('active-section-display').innerText = 
                section === 'COMBINED' ? "Combined (Section A + B)" : `Section ${section}`;

            ['A', 'B', 'COMBINED'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                btn.classList.toggle('bg-black', t === section);
                btn.classList.toggle('text-white', t === section);
                btn.classList.toggle('bg-white', t !== section);
                btn.classList.toggle('text-black', t !== section);
            });

            if (section === 'COMBINED') {
                document.getElementById('legend-combined').classList.remove('hidden');
                document.getElementById('legend-courses').classList.add('hidden');
            } else {
                document.getElementById('legend-combined').classList.add('hidden');
                document.getElementById('legend-courses').classList.remove('hidden');
                renderCourseLegend();
            }
            render();
        }

        function renderCourseLegend() {
            const container = document.getElementById('legend-courses');
            container.innerHTML = Object.keys(courseDetails).map(id => `
                <div class="flex items-center gap-1.5 md:gap-3">
                    <div class="w-3 h-3 md:w-5 md:h-5 rounded border-2 border-black" style="background-color: ${courseDetails[id].color}"></div>
                    <span class="text-[8px] md:text-[10px] font-extrabold uppercase tracking-tight">${id}: ${courseDetails[id].name}</span>
                </div>
            `).join('');
        }

        function getCellColor(info) {
            return currentSection === 'COMBINED' ? sectionColors[info.section] : courseDetails[info.id].color;
        }

        function render() {
            const container = document.getElementById('grid-container');
            container.innerHTML = '';
            const isMobile = window.innerWidth < 768;

            if (!isMobile) {
                // DESKTOP GRID RENDERING
                const header = document.createElement('div');
                header.className = "h-10"; container.appendChild(header);
                days.forEach(day => {
                    const div = document.createElement('div');
                    div.className = "text-center font-extrabold text-lg md:text-xl uppercase italic";
                    div.innerText = day.slice(0, 3); container.appendChild(div);
                });

                timeSlots.forEach(slot => {
                    const timeLabel = document.createElement('div');
                    timeLabel.className = "flex items-center justify-center time-label text-sm md:text-lg italic";
                    timeLabel.innerText = slot; container.appendChild(timeLabel);

                    days.forEach(day => {
                        container.appendChild(createCell(day, slot, false));
                    });
                });
            } else {
                // MOBILE STACK RENDERING
                days.forEach(day => {
                    const matchedClassesForDay = scheduleData.filter(item => 
                        item.day === day && (currentSection === 'COMBINED' || item.section === currentSection)
                    );
                    
                    if(matchedClassesForDay.length === 0) return;

                    const daySection = document.createElement('div');
                    daySection.className = "mobile-day-section";
                    daySection.innerHTML = `<div class="mobile-day-title">${day}</div>`;

                    timeSlots.forEach(slot => {
                        const classes = scheduleData.filter(item => 
                            item.day === day && item.time === slot && (currentSection === 'COMBINED' || item.section === currentSection)
                        );
                        if(classes.length === 0) return;

                        const row = document.createElement('div');
                        row.className = "mobile-row";
                        row.innerHTML = `
                            <div class="time-column-mobile">${slot.replace('-', '<br>')}</div>
                            <div class="card-column-mobile"></div>
                        `;
                        const cardContainer = row.querySelector('.card-column-mobile');
                        cardContainer.appendChild(createCell(day, slot, true));
                        daySection.appendChild(row);
                    });
                    container.appendChild(daySection);
                });
            }
        }

        function createCell(day, slot, isMobile) {
            const matchedClasses = scheduleData.filter(item => 
                item.day === day && item.time === slot && (currentSection === 'COMBINED' || item.section === currentSection)
            );

            const cell = document.createElement('div');
            const heightClass = isMobile ? "min-h-[80px]" : "min-h-[120px]";
            cell.className = `${heightClass} rounded-xl cell-border overflow-hidden shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] bg-slate-50 flex flex-col items-center justify-center`;
            
            if (matchedClasses.length === 1) {
                const info = matchedClasses[0];
                cell.style.backgroundColor = getCellColor(info);
                cell.innerHTML = `
                    <div class="flex flex-col items-center justify-center text-center p-2">
                        <div class="text-base md:text-xl font-extrabold leading-none">${info.id}</div>
                        <div class="text-[8px] md:text-[10px] font-bold uppercase tracking-wider my-1 bg-white/50 px-2 rounded-full border border-black/10">R-${info.room}</div>
                        <div class="text-[8px] md:text-[10px] font-bold leading-tight text-black">${courseDetails[info.id].name.split(' ')[0]}</div>
                        ${currentSection === 'COMBINED' ? `<div class="text-[8px] font-black mt-1 text-black/60 italic">SEC ${info.section}</div>` : ''}
                    </div>
                `;
            } else if (matchedClasses.length > 1) {
                const splitContainer = document.createElement('div');
                splitContainer.className = "split-container";
                matchedClasses.forEach((info, idx) => {
                    const half = document.createElement('div');
                    half.className = "split-half";
                    half.style.backgroundColor = getCellColor(info);
                    half.innerHTML = `
                        <div class="text-[10px] md:text-[12px] font-extrabold leading-none">${info.id} (${info.section})</div>
                        <div class="text-[6px] md:text-[8px] font-bold uppercase my-0.5 bg-white/50 px-1 rounded-full border border-black/10">R-${info.room}</div>
                    `;
                    splitContainer.appendChild(half);
                    if (idx < matchedClasses.length - 1) {
                        const div = document.createElement('div'); div.className = "split-divider";
                        splitContainer.appendChild(div);
                    }
                });
                cell.innerHTML = ''; cell.appendChild(splitContainer);
            } else {
                cell.style.border = "none";
                cell.className = `${heightClass} rounded-xl bg-slate-100 flex items-center justify-center`;
                cell.innerHTML = `<div class="w-1 h-1 bg-slate-300 rounded-full"></div>`;
            }
            return cell;
        }

        async function downloadPNG() {
            const area = document.getElementById('capture-area');
            const canvas = await html2canvas(area, { scale: 3, backgroundColor: "#ffffff" });
            const link = document.createElement('a');
            link.download = `Routine_Economics_${currentSection}.png`;
            link.href = canvas.toDataURL('image/png'); link.click();
        }

        window.addEventListener('resize', render);
        window.onload = () => updateView('COMBINED');
    </script>
</body>
</html>
